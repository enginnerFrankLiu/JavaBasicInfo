使用MQ都要考虑到的问题

MQ 的使用场景和用途

1.MQ 如何保证消息不丢失(消息的可靠性)?

2.MQ 如何保证消息不被重复消费?

3.MQ 如何保证消息队列的高可用?

4.如何保证消息按顺序执行?

5.消息积压在队列中如何处理?


MQ 中的常见的面试题：
https://www.jianshu.com/p/8eeac565adaa

第一个就是MQ的应用场景

1.异步处理；主要目的就是减少请求响应的时间，实现非核心话流程（业务）异步处理，提高系统的响应能力;
    例子：注册成功后，发送短信通知
2.业务解耦
消息的生产方和消费方，不需要彼此知晓或者联系，生成者和消费者彼此独立，通过中间的MQ来联系
    例子：生成订单 MQ 扣减库存
3.削峰
  可能-> 生产者的 生成速度过快，而消费者的 消费能力有限，就需要考虑MQ的限流了
   1.该push 模式为 pull 模式
   2.prefetch count / prefetch size;


一个是尽量去避免消息大量堆积的情况
1.设置消息的过期时间TTL,消息过期后，通过死信交换机 进入死信队列-> 存到DB中，后面再重新导入到MQ 中重新消费

2.当事情已经发生了的处理方式：
https://zhuanlan.zhihu.com/p/112681372



消息发送到MQ中，本身MQ 就是一个先进先出的queue，出现乱序的往往是消费端的
比如：
多个消费者，监听同一个queue,当有序的消息A - B -C 分别到达queue后，分别发送到不同的  D E F 三个消费着后，
每个消费者，消费信息的能力(时间) 不一样，所以就无法保证， A - B - C 三个消息的顺序消费的问题了
解决思路：
添加多个queue，把ABC 放到同一个queue中，而这个queue只有一个consumer。
更多细节:
https://xie.infoq.cn/article/c84491a814f99c7b9965732b1

关于消息堆积的问题；
往往是生成的速度大于了消费的速度；
one hour listening log.

4o minutes listening log.

35 minutes english learning.
